import base64
exec(base64.b64decode('aW1wb3J0IG9zLCByYW5kb20sIGJhc2U2NApmcm9tIGNyeXB0b2dyYXBoeS5mZXJuZXQgaW1wb3J0IEZlcm5ldAoKY2xhc3MgWDoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzZWxmLksgPSBGZXJuZXQuZ2VuZXJhdGVfa2V5KCkKICAgICAgICBzZWxmLkMgPSBGZXJuZXQoc2VsZi5LKQogICAgZGVmIEUoc2VsZiwgVCk6CiAgICAgICAgcmV0dXJuIHNlbGYuQy5lbmNyeXB0KFQuZW5jb2RlKCkpLmRlY29kZSgpCiAgICBkZWYgRChzZWxmLCBUKToKICAgICAgICByZXR1cm4gc2VsZi5DLmRlY3J5cHQoVC5lbmNvZGUoKSkuZGVjb2RlKCkKICAgIGRlZiBNKHNlbGYpOgogICAgICAgIEYgPSBvcy5wYXRoLmFic3BhdGgoX19maWxlX18pCiAgICAgICAgd2l0aCBvcGVuKEYsICJyIiwgZW5jb2Rpbmc9InV0Zi04IikgYXMgZjogTCA9IGYucmVhZGxpbmVzKCkKIyBNNTI5MQogICAgICAgIGlmIG5vdCBhbnkoIiMgT0JGIiBpbiB4IGZvciB4IGluIEwpOgogICAgICAgICAgICBMID0gW3gucmVwbGFjZSgiICIsIHJhbmRvbS5jaG9pY2UoWyIiLCAiICIsICIgICJdKSkgZm9yIHggaW4gTF0KICAgICAgICAgICAgcmFuZG9tLnNodWZmbGUoTCkKICAgICAgICAgICAgTC5pbnNlcnQoMCwgIiMgT0JGXG4iKQogICAgICAgIEwuaW5zZXJ0KHJhbmRvbS5yYW5kaW50KDAsIGxlbihMKSksIGYiIyBNe3JhbmRvbS5yYW5kaW50KDEwMDAsIDk5OTkpfVxuIikKICAgICAgICBDID0gYmFzZTY0LmI2NGVuY29kZSgiIi5qb2luKEwpLmVuY29kZSgpKS5kZWNvZGUoKQogICAgICAgIHdpdGggb3BlbihGLCAidyIsIGVuY29kaW5nPSJ1dGYtOCIpIGFzIGY6IGYud3JpdGUoZiJpbXBvcnQgYmFzZTY0XG5leGVjKGJhc2U2NC5iNjRkZWNvZGUoJ3tDfScpLmRlY29kZSgpKSIpCgpPID0gWCgpClQgPSAiU2VjcmV0IgpwcmludCgiRToiLCBPLkUoVCkpCnByaW50KCJEOiIsIE8uRChPLkUoVCkpKQpPLk0oKQo=').decode())